nohup: 忽略输入
{'n_cpu': 0, 'device': device(type='cuda', index=4), 'batch_size_test': 40, 'batch_size': 2, 'lr': 0.001, 'weight_decay': 0, 'display_interval': 250, 'num_epochs': 50, 'early_stopping': True, 'patience': 10, 'gradient_clipping': True, 'clipping_threshold': 1.0, 'input_dim': 8, 'output_dim': 2, 'input_length': 12, 'output_length': 24, 'input_gap': 1, 'pred_shift': 24, 'model_i': 0, 'kernel_size': (3, 3), 'bias': True, 'hidden_dim_1': (128, 128, 128, 128), 'd_attn_1': 32, 'ssr_decay_rate': 8e-05, 'hidden_dim_2': (32, 32, 32, 32), 'd_attn_2': 16, 'hidden_dim_3': (32, 32, 32, 32), 'd_attn_3': 16, 'hidden_dim_4': (32, 32, 32, 32), 'd_attn_4': 16, 'hidden_dim_5': (32, 32, 32, 32), 'd_attn_5': 16, 'use_hc': 1, 'time': 'hybrid', 'save_last': 0}

reading data
(1692, 24, 48, 21, 4) (432, 24, 48, 1, 4)
(1692, 21, 3) (432, 1, 3)
processing training set
(128, 38, 24, 48, 21, 4)
(2688, 38, 24, 48, 4)
(2688, 38, 3)
predData.shape= (2688, 38, 2, 24, 48)
{'sst': (2688, 38, 24, 48, 6), 'nino target': (2688, 38, 3)}
processing eval set
(395, 38, 24, 48, 1, 4)
(395, 38, 24, 48, 4)
(395, 38, 3)
predData.shape= (395, 38, 2, 24, 48)
{'sst': (395, 38, 24, 48, 6), 'nino target': (395, 38, 3)}
Total params num: 6490626
*****************Finish Parameter****************
loading train dataloader
loading eval dataloader

epoch: 1
batch training loss: 978.00, 165.48, score: 11.0563, ssr ratio: 0.9999
batch training loss: 497.60, 30.03, score: 104.8688, ssr ratio: 0.9799
batch training loss: 402.39, 22.38, score: 87.3118, ssr ratio: 0.9599
batch training loss: 370.33, 26.54, score: 78.4804, ssr ratio: 0.9399
batch training loss: 364.10, 21.74, score: 94.8838, ssr ratio: 0.9199
batch training loss: 430.90, 31.44, score: 71.8465, ssr ratio: 0.8999
tensor([0.9283, 0.8749, 0.8287, 0.7942, 0.7702, 0.7512, 0.7358, 0.7228, 0.7100,
        0.6947, 0.6804, 0.6706, 0.6660, 0.6620, 0.6530, 0.6341, 0.6031, 0.5659,
        0.5335, 0.5122, 0.4967, 0.4869, 0.4829, 0.4818], device='cuda:4')
epoch eval loss:
sst: 623.57, nino: 130.24, sc: 47.5232
eval score is improved from -inf to 47.52317, saving model

epoch: 2
batch training loss: 407.10, 27.75, score: 99.9463, ssr ratio: 0.8924
batch training loss: 391.36, 19.41, score: 106.3843, ssr ratio: 0.8724
batch training loss: 438.38, 34.20, score: 71.3748, ssr ratio: 0.8524
batch training loss: 417.35, 21.56, score: 94.8777, ssr ratio: 0.8324
batch training loss: 457.18, 19.35, score: 105.3531, ssr ratio: 0.8124
batch training loss: 405.83, 21.68, score: 77.4327, ssr ratio: 0.7924
tensor([0.9199, 0.8616, 0.8075, 0.7620, 0.7250, 0.6925, 0.6639, 0.6401, 0.6195,
        0.5988, 0.5821, 0.5741, 0.5764, 0.5817, 0.5811, 0.5726, 0.5539, 0.5285,
        0.5090, 0.5024, 0.4983, 0.4947, 0.4942, 0.4949], device='cuda:4')
epoch eval loss:
sst: 607.72, nino: 128.60, sc: 42.8632
Epoch 00002: reducing learning rate of group 0 to 3.0000e-04.
eval score is not improved for 1 epoch

epoch: 3
batch training loss: 369.05, 22.48, score: 99.8099, ssr ratio: 0.7849
batch training loss: 382.81, 17.59, score: 106.5883, ssr ratio: 0.7649
batch training loss: 471.21, 14.39, score: 95.9143, ssr ratio: 0.7449
batch training loss: 412.93, 11.74, score: 107.0609, ssr ratio: 0.7249
batch training loss: 438.94, 24.27, score: 85.7372, ssr ratio: 0.7049
batch training loss: 464.88, 28.96, score: 101.0763, ssr ratio: 0.6849
tensor([0.9386, 0.8906, 0.8456, 0.8064, 0.7719, 0.7384, 0.7063, 0.6765, 0.6486,
        0.6202, 0.5965, 0.5838, 0.5843, 0.5912, 0.5950, 0.5888, 0.5690, 0.5402,
        0.5156, 0.5026, 0.4937, 0.4881, 0.4871, 0.4888], device='cuda:4')
epoch eval loss:
sst: 588.02, nino: 125.56, sc: 44.5721
Epoch 00003: reducing learning rate of group 0 to 1.0000e-04.
eval score is not improved for 2 epoch

epoch: 4
batch training loss: 373.53, 22.79, score: 99.9428, ssr ratio: 0.6774
batch training loss: 375.99, 17.45, score: 99.7675, ssr ratio: 0.6574
batch training loss: 473.95, 30.68, score: 88.4645, ssr ratio: 0.6374
batch training loss: 479.42, 17.74, score: 89.2403, ssr ratio: 0.6174
batch training loss: 459.94, 17.16, score: 106.4046, ssr ratio: 0.5974
batch training loss: 380.47, 29.43, score: 93.9567, ssr ratio: 0.5774
tensor([0.9441, 0.9017, 0.8633, 0.8313, 0.8036, 0.7758, 0.7482, 0.7216, 0.6948,
        0.6659, 0.6404, 0.6244, 0.6204, 0.6212, 0.6184, 0.6056, 0.5802, 0.5484,
        0.5223, 0.5089, 0.5005, 0.4966, 0.4986, 0.5037], device='cuda:4')
epoch eval loss:
sst: 590.18, nino: 127.85, sc: 46.7428
eval score is not improved for 3 epoch

epoch: 5
batch training loss: 498.38, 20.88, score: 86.1640, ssr ratio: 0.5698
batch training loss: 394.29, 37.30, score: 103.4437, ssr ratio: 0.5498
batch training loss: 381.87, 32.60, score: 71.7665, ssr ratio: 0.5298
batch training loss: 385.21, 25.34, score: 95.0483, ssr ratio: 0.5098
batch training loss: 518.55, 16.58, score: 103.8247, ssr ratio: 0.4898
batch training loss: 473.38, 28.74, score: 88.9025, ssr ratio: 0.4698
tensor([0.9439, 0.9002, 0.8599, 0.8249, 0.7936, 0.7623, 0.7314, 0.7018, 0.6720,
        0.6400, 0.6122, 0.5950, 0.5897, 0.5892, 0.5853, 0.5720, 0.5468, 0.5159,
        0.4921, 0.4816, 0.4759, 0.4739, 0.4765, 0.4803], device='cuda:4')
epoch eval loss:
sst: 588.13, nino: 126.90, sc: 43.9570
eval score is not improved for 4 epoch

epoch: 6
batch training loss: 441.96, 46.26, score: 102.8651, ssr ratio: 0.4623
batch training loss: 500.44, 25.46, score: 93.0906, ssr ratio: 0.4423
batch training loss: 443.06, 30.52, score: 99.7397, ssr ratio: 0.4223
batch training loss: 441.80, 21.94, score: 56.6537, ssr ratio: 0.4023
batch training loss: 527.94, 30.63, score: 92.5480, ssr ratio: 0.3823
batch training loss: 562.50, 36.66, score: 92.9794, ssr ratio: 0.3623
tensor([0.9429, 0.8994, 0.8595, 0.8262, 0.7970, 0.7685, 0.7415, 0.7169, 0.6919,
        0.6636, 0.6382, 0.6225, 0.6200, 0.6234, 0.6236, 0.6124, 0.5870, 0.5544,
        0.5282, 0.5153, 0.5067, 0.5019, 0.5025, 0.5060], device='cuda:4')
epoch eval loss:
sst: 583.11, nino: 124.46, sc: 47.4039
eval score is not improved for 5 epoch

epoch: 7
batch training loss: 442.80, 19.60, score: 94.3014, ssr ratio: 0.3548
batch training loss: 524.76, 31.79, score: 75.9879, ssr ratio: 0.3348
batch training loss: 515.10, 54.80, score: 102.4997, ssr ratio: 0.3148
batch training loss: 424.02, 36.80, score: -2.5286, ssr ratio: 0.2948
batch training loss: 496.74, 28.81, score: 104.8941, ssr ratio: 0.2748
batch training loss: 530.97, 25.45, score: 67.8854, ssr ratio: 0.2548
tensor([0.9408, 0.8950, 0.8527, 0.8175, 0.7873, 0.7579, 0.7297, 0.7040, 0.6797,
        0.6545, 0.6343, 0.6238, 0.6243, 0.6284, 0.6279, 0.6160, 0.5904, 0.5581,
        0.5322, 0.5192, 0.5106, 0.5059, 0.5061, 0.5087], device='cuda:4')
epoch eval loss:
sst: 587.23, nino: 122.32, sc: 47.6711
eval score is improved from 47.52317 to 47.67112, saving model

epoch: 8
batch training loss: 472.53, 28.87, score: 104.2127, ssr ratio: 0.2473
batch training loss: 459.20, 39.98, score: 102.4498, ssr ratio: 0.2273
batch training loss: 435.59, 42.56, score: 103.8929, ssr ratio: 0.2073
batch training loss: 502.87, 22.91, score: 106.1393, ssr ratio: 0.1873
batch training loss: 563.34, 51.73, score: 23.5266, ssr ratio: 0.1673
batch training loss: 499.27, 64.22, score: 99.6984, ssr ratio: 0.1473
tensor([0.9403, 0.8940, 0.8516, 0.8173, 0.7883, 0.7606, 0.7347, 0.7113, 0.6878,
        0.6619, 0.6404, 0.6298, 0.6308, 0.6344, 0.6323, 0.6187, 0.5916, 0.5581,
        0.5322, 0.5202, 0.5128, 0.5096, 0.5115, 0.5148], device='cuda:4')
epoch eval loss:
sst: 585.86, nino: 122.00, sc: 48.1389
eval score is improved from 47.67112 to 48.13889, saving model

epoch: 9
batch training loss: 483.26, 32.94, score: 87.6310, ssr ratio: 0.1398
batch training loss: 462.76, 28.73, score: 98.4840, ssr ratio: 0.1198
batch training loss: 547.99, 98.42, score: 11.3706, ssr ratio: 0.0998
batch training loss: 487.06, 38.22, score: 77.0429, ssr ratio: 0.0798
batch training loss: 574.99, 50.95, score: 102.7399, ssr ratio: 0.0598
batch training loss: 510.74, 45.64, score: 78.9302, ssr ratio: 0.0398
tensor([0.9385, 0.8915, 0.8487, 0.8135, 0.7822, 0.7513, 0.7228, 0.6972, 0.6724,
        0.6463, 0.6262, 0.6171, 0.6197, 0.6251, 0.6246, 0.6117, 0.5851, 0.5530,
        0.5290, 0.5187, 0.5127, 0.5103, 0.5117, 0.5148], device='cuda:4')
epoch eval loss:
sst: 589.33, nino: 122.38, sc: 47.4635
eval score is not improved for 1 epoch

epoch: 10
batch training loss: 548.34, 25.91, score: 85.7934, ssr ratio: 0.0322
batch training loss: 520.25, 39.57, score: 101.5196, ssr ratio: 0.0122
batch training loss: 539.48, 27.74, score: 55.2349, ssr ratio: 0.0000
batch training loss: 518.88, 106.75, score: 63.4615, ssr ratio: 0.0000
batch training loss: 555.55, 44.32, score: 103.5346, ssr ratio: 0.0000
batch training loss: 603.34, 32.23, score: 87.1761, ssr ratio: 0.0000
tensor([0.9401, 0.8944, 0.8529, 0.8188, 0.7884, 0.7580, 0.7293, 0.7032, 0.6780,
        0.6523, 0.6328, 0.6243, 0.6271, 0.6323, 0.6311, 0.6179, 0.5913, 0.5588,
        0.5341, 0.5231, 0.5167, 0.5143, 0.5163, 0.5197], device='cuda:4')
epoch eval loss:
sst: 589.72, nino: 121.54, sc: 48.2080
eval score is improved from 48.13889 to 48.20800, saving model

epoch: 11
batch training loss: 548.51, 38.31, score: 92.9696, ssr ratio: 0.0000
batch training loss: 567.21, 58.44, score: 75.5215, ssr ratio: 0.0000
batch training loss: 518.13, 72.70, score: 11.1713, ssr ratio: 0.0000
batch training loss: 577.46, 95.60, score: 96.1761, ssr ratio: 0.0000
batch training loss: 517.91, 56.37, score: -14.6161, ssr ratio: 0.0000
batch training loss: 554.48, 43.60, score: 68.2398, ssr ratio: 0.0000
tensor([0.9397, 0.8945, 0.8529, 0.8173, 0.7845, 0.7517, 0.7204, 0.6914, 0.6633,
        0.6350, 0.6141, 0.6058, 0.6100, 0.6165, 0.6154, 0.6011, 0.5729, 0.5391,
        0.5136, 0.5030, 0.4975, 0.4960, 0.4985, 0.5027], device='cuda:4')
epoch eval loss:
sst: 591.44, nino: 125.04, sc: 45.9113
eval score is not improved for 1 epoch

epoch: 12
batch training loss: 529.63, 19.93, score: 81.5422, ssr ratio: 0.0000
batch training loss: 490.03, 34.75, score: 92.7498, ssr ratio: 0.0000
batch training loss: 475.35, 44.22, score: -0.0670, ssr ratio: 0.0000
batch training loss: 531.09, 103.71, score: 65.6664, ssr ratio: 0.0000
batch training loss: 557.73, 34.82, score: -18.9353, ssr ratio: 0.0000
batch training loss: 498.55, 24.18, score: 105.2906, ssr ratio: 0.0000
tensor([0.9417, 0.8963, 0.8552, 0.8209, 0.7900, 0.7591, 0.7298, 0.7026, 0.6750,
        0.6464, 0.6251, 0.6164, 0.6194, 0.6240, 0.6221, 0.6079, 0.5800, 0.5458,
        0.5196, 0.5077, 0.5009, 0.4986, 0.5005, 0.5035], device='cuda:4')
epoch eval loss:
sst: 589.14, nino: 123.07, sc: 46.8473
eval score is not improved for 2 epoch

epoch: 13
batch training loss: 598.78, 109.98, score: 95.0801, ssr ratio: 0.0000
batch training loss: 558.85, 41.14, score: 70.2711, ssr ratio: 0.0000
batch training loss: 592.46, 25.37, score: 105.6735, ssr ratio: 0.0000
batch training loss: 588.93, 38.00, score: 102.7784, ssr ratio: 0.0000
batch training loss: 508.19, 58.94, score: 78.7351, ssr ratio: 0.0000
batch training loss: 556.42, 47.37, score: 87.7368, ssr ratio: 0.0000
tensor([0.9422, 0.8956, 0.8505, 0.8096, 0.7700, 0.7299, 0.6927, 0.6603, 0.6308,
        0.6034, 0.5862, 0.5830, 0.5923, 0.6032, 0.6059, 0.5938, 0.5659, 0.5310,
        0.5043, 0.4933, 0.4885, 0.4892, 0.4938, 0.4991], device='cuda:4')
epoch eval loss:
sst: 589.79, nino: 124.85, sc: 44.5608
eval score is not improved for 3 epoch

epoch: 14
batch training loss: 521.24, 31.22, score: 98.8981, ssr ratio: 0.0000
batch training loss: 552.96, 40.27, score: 96.0276, ssr ratio: 0.0000
batch training loss: 515.76, 41.96, score: 86.8109, ssr ratio: 0.0000
batch training loss: 560.57, 42.16, score: 104.0328, ssr ratio: 0.0000
batch training loss: 542.51, 27.41, score: 67.1838, ssr ratio: 0.0000
batch training loss: 518.23, 52.08, score: 102.7801, ssr ratio: 0.0000
tensor([0.9449, 0.9020, 0.8638, 0.8321, 0.8029, 0.7721, 0.7411, 0.7109, 0.6810,
        0.6509, 0.6287, 0.6198, 0.6230, 0.6275, 0.6248, 0.6101, 0.5817, 0.5471,
        0.5206, 0.5088, 0.5026, 0.5013, 0.5042, 0.5076], device='cuda:4')
epoch eval loss:
sst: 588.58, nino: 122.06, sc: 47.4836
eval score is not improved for 4 epoch

epoch: 15
batch training loss: 534.56, 39.94, score: 80.3736, ssr ratio: 0.0000
batch training loss: 554.87, 36.87, score: 94.2981, ssr ratio: 0.0000
batch training loss: 601.42, 80.84, score: 42.6317, ssr ratio: 0.0000
batch training loss: 499.16, 57.12, score: 99.9191, ssr ratio: 0.0000
batch training loss: 469.03, 31.48, score: 102.4540, ssr ratio: 0.0000
batch training loss: 573.72, 61.18, score: 52.7119, ssr ratio: 0.0000
tensor([0.9438, 0.9003, 0.8608, 0.8271, 0.7950, 0.7610, 0.7276, 0.6966, 0.6675,
        0.6402, 0.6217, 0.6161, 0.6222, 0.6292, 0.6281, 0.6141, 0.5863, 0.5521,
        0.5257, 0.5142, 0.5079, 0.5062, 0.5083, 0.5107], device='cuda:4')
epoch eval loss:
sst: 591.00, nino: 122.77, sc: 47.3171
eval score is not improved for 5 epoch

epoch: 16
batch training loss: 510.43, 32.31, score: 46.9705, ssr ratio: 0.0000
batch training loss: 591.75, 55.33, score: -6.1982, ssr ratio: 0.0000
batch training loss: 480.77, 56.87, score: 87.1530, ssr ratio: 0.0000
batch training loss: 525.27, 22.94, score: 77.3402, ssr ratio: 0.0000
batch training loss: 534.73, 75.77, score: 57.2338, ssr ratio: 0.0000
batch training loss: 525.94, 44.39, score: 69.2974, ssr ratio: 0.0000
tensor([0.9412, 0.8957, 0.8534, 0.8167, 0.7820, 0.7469, 0.7143, 0.6860, 0.6596,
        0.6329, 0.6138, 0.6080, 0.6148, 0.6232, 0.6232, 0.6104, 0.5842, 0.5517,
        0.5261, 0.5150, 0.5099, 0.5095, 0.5133, 0.5184], device='cuda:4')
epoch eval loss:
sst: 591.40, nino: 122.93, sc: 47.0876
eval score is not improved for 6 epoch

epoch: 17
batch training loss: 463.23, 49.19, score: 68.5877, ssr ratio: 0.0000
batch training loss: 520.36, 29.79, score: 105.2198, ssr ratio: 0.0000
batch training loss: 549.77, 33.25, score: 103.7638, ssr ratio: 0.0000
batch training loss: 602.95, 35.86, score: 52.5936, ssr ratio: 0.0000
batch training loss: 485.79, 60.32, score: 64.9870, ssr ratio: 0.0000
batch training loss: 617.61, 37.77, score: 47.5116, ssr ratio: 0.0000
tensor([0.9422, 0.8982, 0.8578, 0.8237, 0.7914, 0.7577, 0.7248, 0.6948, 0.6664,
        0.6388, 0.6192, 0.6119, 0.6163, 0.6224, 0.6214, 0.6078, 0.5805, 0.5458,
        0.5172, 0.5027, 0.4948, 0.4927, 0.4951, 0.4994], device='cuda:4')
epoch eval loss:
sst: 590.05, nino: 122.93, sc: 46.4828
eval score is not improved for 7 epoch

epoch: 18
batch training loss: 492.54, 32.68, score: 92.0804, ssr ratio: 0.0000
batch training loss: 528.81, 60.52, score: -92.7469, ssr ratio: 0.0000
batch training loss: 562.85, 50.53, score: 0.3401, ssr ratio: 0.0000
batch training loss: 596.66, 72.77, score: 100.3075, ssr ratio: 0.0000
batch training loss: 574.21, 32.36, score: -23.2712, ssr ratio: 0.0000
batch training loss: 503.80, 35.25, score: 104.0182, ssr ratio: 0.0000
tensor([0.9417, 0.8963, 0.8539, 0.8167, 0.7809, 0.7437, 0.7084, 0.6778, 0.6501,
        0.6236, 0.6053, 0.6000, 0.6069, 0.6144, 0.6138, 0.6005, 0.5736, 0.5391,
        0.5110, 0.4973, 0.4901, 0.4892, 0.4938, 0.5005], device='cuda:4')
epoch eval loss:
sst: 589.95, nino: 123.74, sc: 45.5468
eval score is not improved for 8 epoch

epoch: 19
batch training loss: 532.76, 40.64, score: 104.5520, ssr ratio: 0.0000
batch training loss: 487.57, 48.15, score: 76.1495, ssr ratio: 0.0000
batch training loss: 527.23, 25.91, score: 100.6900, ssr ratio: 0.0000
batch training loss: 480.13, 35.48, score: 97.8807, ssr ratio: 0.0000
batch training loss: 550.47, 92.74, score: 75.1264, ssr ratio: 0.0000
batch training loss: 526.20, 51.91, score: 98.5005, ssr ratio: 0.0000
tensor([0.9446, 0.9009, 0.8601, 0.8248, 0.7910, 0.7545, 0.7169, 0.6806, 0.6468,
        0.6163, 0.5962, 0.5911, 0.6000, 0.6108, 0.6127, 0.5996, 0.5711, 0.5347,
        0.5057, 0.4932, 0.4882, 0.4884, 0.4926, 0.4981], device='cuda:4')
epoch eval loss:
sst: 595.86, nino: 124.23, sc: 45.3672
eval score is not improved for 9 epoch

epoch: 20
batch training loss: 619.74, 63.94, score: 69.1634, ssr ratio: 0.0000
batch training loss: 594.22, 36.18, score: 83.0068, ssr ratio: 0.0000
batch training loss: 563.14, 45.85, score: 102.7110, ssr ratio: 0.0000
batch training loss: 500.77, 25.91, score: 88.5236, ssr ratio: 0.0000
batch training loss: 563.57, 32.89, score: 104.8313, ssr ratio: 0.0000
batch training loss: 547.56, 40.27, score: 96.2586, ssr ratio: 0.0000
tensor([0.9420, 0.8969, 0.8555, 0.8211, 0.7902, 0.7576, 0.7242, 0.6914, 0.6590,
        0.6278, 0.6065, 0.5997, 0.6073, 0.6170, 0.6185, 0.6056, 0.5789, 0.5450,
        0.5185, 0.5075, 0.5030, 0.5036, 0.5085, 0.5152], device='cuda:4')
epoch eval loss:
sst: 590.91, nino: 123.57, sc: 46.4718
eval score is not improved for 10 epoch
early stopping reached, best score is 48.207999

----- training finished -----

processing test set
(395, 38, 24, 48, 1, 4)
(395, 38, 24, 48, 4)
(395, 38, 3)
predData.shape= (395, 38, 2, 24, 48)
{'sst': (395, 38, 24, 48, 6), 'nino target': (395, 38, 3)}
loading test dataloader
testing...
tensor([0.9401, 0.8944, 0.8529, 0.8188, 0.7884, 0.7580, 0.7293, 0.7032, 0.6780,
        0.6523, 0.6328, 0.6243, 0.6271, 0.6323, 0.6311, 0.6179, 0.5913, 0.5588,
        0.5341, 0.5231, 0.5167, 0.5143, 0.5163, 0.5197], device='cuda:4')
test loss:
 sst: 589.72, nino: 121.54, score: 48.2080
