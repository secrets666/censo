nohup: 忽略输入
{'n_cpu': 0, 'device': device(type='cuda', index=3), 'batch_size_test': 40, 'batch_size': 2, 'lr': 0.001, 'weight_decay': 0, 'display_interval': 250, 'num_epochs': 50, 'early_stopping': True, 'patience': 10, 'gradient_clipping': True, 'clipping_threshold': 1.0, 'input_dim': 8, 'output_dim': 2, 'input_length': 12, 'output_length': 24, 'input_gap': 1, 'pred_shift': 24, 'model_i': 0, 'kernel_size': (3, 3), 'bias': True, 'hidden_dim_1': (64, 64, 64, 64), 'd_attn_1': 128, 'ssr_decay_rate': 8e-05, 'hidden_dim_2': (32, 32, 32, 32), 'd_attn_2': 16, 'hidden_dim_3': (32, 32, 32, 32), 'd_attn_3': 16, 'hidden_dim_4': (32, 32, 32, 32), 'd_attn_4': 16, 'hidden_dim_5': (32, 32, 32, 32), 'd_attn_5': 16, 'use_hc': 1, 'time': 'hybrid', 'save_last': 0}

reading data
(1692, 24, 48, 21, 4) (432, 24, 48, 1, 4)
(1692, 21, 3) (432, 1, 3)
processing training set
(128, 38, 24, 48, 21, 4)
(2688, 38, 24, 48, 4)
(2688, 38, 3)
predData.shape= (2688, 38, 2, 24, 48)
{'sst': (2688, 38, 24, 48, 6), 'nino target': (2688, 38, 3)}
processing eval set
(395, 38, 24, 48, 1, 4)
(395, 38, 24, 48, 4)
(395, 38, 3)
predData.shape= (395, 38, 2, 24, 48)
{'sst': (395, 38, 24, 48, 6), 'nino target': (395, 38, 3)}
Total params num: 2696066
*****************Finish Parameter****************
loading train dataloader
loading eval dataloader

epoch: 1
batch training loss: 957.59, 164.68, score: 2.8678, ssr ratio: 0.9999
batch training loss: 516.37, 26.26, score: 105.3080, ssr ratio: 0.9799
batch training loss: 403.97, 15.70, score: 87.6475, ssr ratio: 0.9599
batch training loss: 370.99, 22.58, score: 79.2135, ssr ratio: 0.9399
batch training loss: 364.39, 26.30, score: 94.3462, ssr ratio: 0.9199
batch training loss: 432.44, 29.77, score: 61.4841, ssr ratio: 0.8999
tensor([0.9283, 0.8773, 0.8354, 0.8046, 0.7834, 0.7668, 0.7542, 0.7430, 0.7297,
        0.7128, 0.6970, 0.6863, 0.6810, 0.6761, 0.6668, 0.6468, 0.6147, 0.5765,
        0.5440, 0.5233, 0.5113, 0.5094, 0.5181, 0.5314], device='cuda:3')
epoch eval loss:
sst: 718.93, nino: 137.56, sc: 49.2571
eval score is improved from -inf to 49.25708, saving model

epoch: 2
batch training loss: 411.96, 20.41, score: 100.6374, ssr ratio: 0.8924
batch training loss: 393.89, 24.67, score: 105.5877, ssr ratio: 0.8724
batch training loss: 444.46, 41.77, score: 70.5052, ssr ratio: 0.8524
batch training loss: 419.36, 23.62, score: 94.7011, ssr ratio: 0.8324
batch training loss: 458.79, 17.35, score: 105.8967, ssr ratio: 0.8124
batch training loss: 408.29, 19.59, score: 77.6720, ssr ratio: 0.7924
tensor([0.9189, 0.8555, 0.7940, 0.7354, 0.6766, 0.6158, 0.5581, 0.5090, 0.4691,
        0.4363, 0.4155, 0.4079, 0.4128, 0.4237, 0.4322, 0.4338, 0.4246, 0.4075,
        0.3955, 0.3955, 0.3984, 0.4023, 0.4083, 0.4161], device='cuda:3')
epoch eval loss:
sst: 616.21, nino: 135.66, sc: 29.3089
Epoch 00002: reducing learning rate of group 0 to 3.0000e-04.
eval score is not improved for 1 epoch

epoch: 3
batch training loss: 368.66, 19.89, score: 100.0027, ssr ratio: 0.7849
batch training loss: 386.02, 15.35, score: 106.9947, ssr ratio: 0.7649
batch training loss: 473.14, 14.09, score: 95.9427, ssr ratio: 0.7449
batch training loss: 416.64, 12.26, score: 102.6720, ssr ratio: 0.7249
batch training loss: 445.07, 25.30, score: 85.5976, ssr ratio: 0.7049
batch training loss: 470.91, 32.73, score: 100.6890, ssr ratio: 0.6849
tensor([0.9397, 0.8929, 0.8502, 0.8150, 0.7855, 0.7576, 0.7315, 0.7076, 0.6848,
        0.6603, 0.6387, 0.6263, 0.6248, 0.6285, 0.6292, 0.6210, 0.5999, 0.5693,
        0.5424, 0.5274, 0.5169, 0.5101, 0.5081, 0.5083], device='cuda:3')
epoch eval loss:
sst: 593.37, nino: 122.17, sc: 48.1269
Epoch 00003: reducing learning rate of group 0 to 1.0000e-04.
eval score is not improved for 2 epoch

epoch: 4
batch training loss: 378.43, 22.43, score: 106.3974, ssr ratio: 0.6774
batch training loss: 382.30, 17.78, score: 99.6427, ssr ratio: 0.6574
batch training loss: 480.37, 29.11, score: 88.5267, ssr ratio: 0.6374
batch training loss: 485.20, 18.23, score: 89.2409, ssr ratio: 0.6174
batch training loss: 466.86, 17.29, score: 106.4728, ssr ratio: 0.5974
batch training loss: 387.65, 32.95, score: 82.2919, ssr ratio: 0.5774
tensor([0.9422, 0.8979, 0.8573, 0.8225, 0.7916, 0.7608, 0.7315, 0.7051, 0.6803,
        0.6542, 0.6316, 0.6181, 0.6158, 0.6181, 0.6168, 0.6056, 0.5808, 0.5467,
        0.5172, 0.5005, 0.4888, 0.4815, 0.4794, 0.4800], device='cuda:3')
epoch eval loss:
sst: 593.94, nino: 131.26, sc: 45.3049
eval score is not improved for 3 epoch

epoch: 5
batch training loss: 505.56, 24.01, score: 95.8574, ssr ratio: 0.5698
batch training loss: 398.75, 37.04, score: 103.7380, ssr ratio: 0.5498
batch training loss: 385.03, 33.44, score: 60.5158, ssr ratio: 0.5298
batch training loss: 390.22, 27.82, score: 94.7608, ssr ratio: 0.5098
batch training loss: 523.23, 14.75, score: 106.6227, ssr ratio: 0.4898
batch training loss: 481.90, 30.50, score: 88.7680, ssr ratio: 0.4698
tensor([0.9414, 0.8960, 0.8558, 0.8219, 0.7915, 0.7600, 0.7284, 0.6984, 0.6690,
        0.6385, 0.6133, 0.5992, 0.5977, 0.6012, 0.6014, 0.5918, 0.5687, 0.5369,
        0.5104, 0.4971, 0.4890, 0.4849, 0.4851, 0.4866], device='cuda:3')
epoch eval loss:
sst: 589.73, nino: 125.58, sc: 45.2115
eval score is not improved for 4 epoch

epoch: 6
batch training loss: 448.23, 51.01, score: 86.3191, ssr ratio: 0.4623
batch training loss: 505.75, 26.52, score: 92.9469, ssr ratio: 0.4423
batch training loss: 450.26, 32.84, score: 97.8602, ssr ratio: 0.4223
batch training loss: 446.65, 21.59, score: 72.9639, ssr ratio: 0.4023
batch training loss: 535.51, 34.17, score: 92.5170, ssr ratio: 0.3823
batch training loss: 573.13, 38.32, score: 92.9317, ssr ratio: 0.3623
tensor([0.9388, 0.8928, 0.8515, 0.8183, 0.7910, 0.7640, 0.7379, 0.7133, 0.6886,
        0.6619, 0.6396, 0.6273, 0.6268, 0.6307, 0.6311, 0.6211, 0.5972, 0.5644,
        0.5367, 0.5217, 0.5116, 0.5059, 0.5054, 0.5073], device='cuda:3')
epoch eval loss:
sst: 586.02, nino: 122.43, sc: 48.0616
eval score is not improved for 5 epoch

epoch: 7
batch training loss: 450.17, 17.75, score: 94.5159, ssr ratio: 0.3548
batch training loss: 531.40, 34.07, score: 75.7104, ssr ratio: 0.3348
batch training loss: 519.27, 52.01, score: 102.5270, ssr ratio: 0.3148
batch training loss: 430.74, 38.22, score: -20.6845, ssr ratio: 0.2948
batch training loss: 501.61, 27.86, score: 104.7302, ssr ratio: 0.2748
batch training loss: 536.37, 25.91, score: 67.8071, ssr ratio: 0.2548
tensor([0.9411, 0.8956, 0.8543, 0.8203, 0.7913, 0.7627, 0.7356, 0.7109, 0.6875,
        0.6635, 0.6439, 0.6333, 0.6328, 0.6355, 0.6336, 0.6211, 0.5953, 0.5616,
        0.5334, 0.5178, 0.5074, 0.5015, 0.5005, 0.5027], device='cuda:3')
epoch eval loss:
sst: 590.20, nino: 122.05, sc: 48.0055
eval score is not improved for 6 epoch

epoch: 8
batch training loss: 481.22, 29.38, score: 103.9758, ssr ratio: 0.2473
batch training loss: 464.53, 35.89, score: 102.9715, ssr ratio: 0.2273
batch training loss: 442.50, 41.74, score: 101.8117, ssr ratio: 0.2073
batch training loss: 512.46, 22.67, score: 105.9865, ssr ratio: 0.1873
batch training loss: 571.12, 52.88, score: 23.4723, ssr ratio: 0.1673
batch training loss: 509.17, 63.09, score: 99.7520, ssr ratio: 0.1473
tensor([0.9382, 0.8918, 0.8501, 0.8158, 0.7853, 0.7547, 0.7262, 0.7010, 0.6773,
        0.6534, 0.6349, 0.6265, 0.6286, 0.6326, 0.6310, 0.6182, 0.5915, 0.5572,
        0.5297, 0.5154, 0.5059, 0.5011, 0.5019, 0.5050], device='cuda:3')
epoch eval loss:
sst: 588.03, nino: 122.41, sc: 47.5326
eval score is not improved for 7 epoch

epoch: 9
batch training loss: 488.15, 33.89, score: 87.4743, ssr ratio: 0.1398
batch training loss: 466.17, 30.69, score: 104.9993, ssr ratio: 0.1198
batch training loss: 553.16, 98.48, score: 11.3739, ssr ratio: 0.0998
batch training loss: 494.05, 40.27, score: 65.3560, ssr ratio: 0.0798
batch training loss: 580.02, 49.51, score: 87.2722, ssr ratio: 0.0598
batch training loss: 514.83, 49.29, score: 95.7008, ssr ratio: 0.0398
tensor([0.9369, 0.8896, 0.8467, 0.8112, 0.7798, 0.7483, 0.7195, 0.6944, 0.6711,
        0.6478, 0.6304, 0.6228, 0.6258, 0.6312, 0.6312, 0.6191, 0.5928, 0.5598,
        0.5345, 0.5226, 0.5153, 0.5122, 0.5141, 0.5180], device='cuda:3')
epoch eval loss:
sst: 590.30, nino: 121.85, sc: 47.9207
eval score is not improved for 8 epoch

epoch: 10
batch training loss: 553.94, 25.23, score: 85.9572, ssr ratio: 0.0322
batch training loss: 532.05, 45.71, score: 100.6895, ssr ratio: 0.0122
batch training loss: 546.46, 29.14, score: 55.3949, ssr ratio: 0.0000
batch training loss: 524.43, 110.37, score: 63.2516, ssr ratio: 0.0000
batch training loss: 560.71, 45.98, score: 98.1481, ssr ratio: 0.0000
batch training loss: 611.17, 32.59, score: 87.1188, ssr ratio: 0.0000
tensor([0.9405, 0.8948, 0.8531, 0.8188, 0.7878, 0.7557, 0.7253, 0.6981, 0.6730,
        0.6488, 0.6312, 0.6239, 0.6269, 0.6320, 0.6314, 0.6187, 0.5918, 0.5577,
        0.5313, 0.5187, 0.5106, 0.5068, 0.5083, 0.5122], device='cuda:3')
epoch eval loss:
sst: 589.68, nino: 121.71, sc: 47.8357
eval score is not improved for 9 epoch

epoch: 11
batch training loss: 555.83, 39.64, score: 97.5763, ssr ratio: 0.0000
batch training loss: 573.83, 66.05, score: 74.6077, ssr ratio: 0.0000
batch training loss: 522.33, 72.74, score: 10.9288, ssr ratio: 0.0000
batch training loss: 583.67, 93.80, score: 96.2374, ssr ratio: 0.0000
batch training loss: 522.32, 58.01, score: 0.9769, ssr ratio: 0.0000
batch training loss: 559.80, 44.73, score: 70.2605, ssr ratio: 0.0000
tensor([0.9379, 0.8930, 0.8517, 0.8164, 0.7834, 0.7496, 0.7175, 0.6890, 0.6625,
        0.6368, 0.6179, 0.6098, 0.6129, 0.6188, 0.6186, 0.6056, 0.5780, 0.5436,
        0.5171, 0.5046, 0.4971, 0.4936, 0.4950, 0.4987], device='cuda:3')
epoch eval loss:
sst: 591.56, nino: 124.73, sc: 46.0691
eval score is not improved for 10 epoch
early stopping reached, best score is 49.257080

----- training finished -----

processing test set
(395, 38, 24, 48, 1, 4)
(395, 38, 24, 48, 4)
(395, 38, 3)
predData.shape= (395, 38, 2, 24, 48)
{'sst': (395, 38, 24, 48, 6), 'nino target': (395, 38, 3)}
loading test dataloader
Traceback (most recent call last):
  File "trainer.py", line 264, in <module>
    trainer.network.load_state_dict(chk['net'])
  File "/home/ruichuang/anaconda3/envs/AGCRN_env/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1604, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for SAConvLSTM:
	size mismatch for layers.0.conv.weight: copying a param with shape torch.Size([512, 136, 3, 3]) from checkpoint, the shape in current model is torch.Size([256, 72, 3, 3]).
	size mismatch for layers.0.conv.bias: copying a param with shape torch.Size([512]) from checkpoint, the shape in current model is torch.Size([256]).
	size mismatch for layers.0.sa.conv_h.weight: copying a param with shape torch.Size([96, 128, 1, 1]) from checkpoint, the shape in current model is torch.Size([384, 64, 1, 1]).
	size mismatch for layers.0.sa.conv_h.bias: copying a param with shape torch.Size([96]) from checkpoint, the shape in current model is torch.Size([384]).
	size mismatch for layers.0.sa.conv_m.weight: copying a param with shape torch.Size([64, 128, 1, 1]) from checkpoint, the shape in current model is torch.Size([256, 64, 1, 1]).
	size mismatch for layers.0.sa.conv_m.bias: copying a param with shape torch.Size([64]) from checkpoint, the shape in current model is torch.Size([256]).
	size mismatch for layers.0.sa.conv_z.weight: copying a param with shape torch.Size([32, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([128, 256, 1, 1]).
	size mismatch for layers.0.sa.conv_z.bias: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([128]).
	size mismatch for layers.0.sa.conv_output.weight: copying a param with shape torch.Size([384, 160, 3, 3]) from checkpoint, the shape in current model is torch.Size([192, 192, 3, 3]).
	size mismatch for layers.0.sa.conv_output.bias: copying a param with shape torch.Size([384]) from checkpoint, the shape in current model is torch.Size([192]).
	size mismatch for layers.1.conv.weight: copying a param with shape torch.Size([512, 256, 3, 3]) from checkpoint, the shape in current model is torch.Size([256, 128, 3, 3]).
	size mismatch for layers.1.conv.bias: copying a param with shape torch.Size([512]) from checkpoint, the shape in current model is torch.Size([256]).
	size mismatch for layers.1.sa.conv_h.weight: copying a param with shape torch.Size([96, 128, 1, 1]) from checkpoint, the shape in current model is torch.Size([384, 64, 1, 1]).
	size mismatch for layers.1.sa.conv_h.bias: copying a param with shape torch.Size([96]) from checkpoint, the shape in current model is torch.Size([384]).
	size mismatch for layers.1.sa.conv_m.weight: copying a param with shape torch.Size([64, 128, 1, 1]) from checkpoint, the shape in current model is torch.Size([256, 64, 1, 1]).
	size mismatch for layers.1.sa.conv_m.bias: copying a param with shape torch.Size([64]) from checkpoint, the shape in current model is torch.Size([256]).
	size mismatch for layers.1.sa.conv_z.weight: copying a param with shape torch.Size([32, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([128, 256, 1, 1]).
	size mismatch for layers.1.sa.conv_z.bias: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([128]).
	size mismatch for layers.1.sa.conv_output.weight: copying a param with shape torch.Size([384, 160, 3, 3]) from checkpoint, the shape in current model is torch.Size([192, 192, 3, 3]).
	size mismatch for layers.1.sa.conv_output.bias: copying a param with shape torch.Size([384]) from checkpoint, the shape in current model is torch.Size([192]).
	size mismatch for layers.2.conv.weight: copying a param with shape torch.Size([512, 256, 3, 3]) from checkpoint, the shape in current model is torch.Size([256, 128, 3, 3]).
	size mismatch for layers.2.conv.bias: copying a param with shape torch.Size([512]) from checkpoint, the shape in current model is torch.Size([256]).
	size mismatch for layers.2.sa.conv_h.weight: copying a param with shape torch.Size([96, 128, 1, 1]) from checkpoint, the shape in current model is torch.Size([384, 64, 1, 1]).
	size mismatch for layers.2.sa.conv_h.bias: copying a param with shape torch.Size([96]) from checkpoint, the shape in current model is torch.Size([384]).
	size mismatch for layers.2.sa.conv_m.weight: copying a param with shape torch.Size([64, 128, 1, 1]) from checkpoint, the shape in current model is torch.Size([256, 64, 1, 1]).
	size mismatch for layers.2.sa.conv_m.bias: copying a param with shape torch.Size([64]) from checkpoint, the shape in current model is torch.Size([256]).
	size mismatch for layers.2.sa.conv_z.weight: copying a param with shape torch.Size([32, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([128, 256, 1, 1]).
	size mismatch for layers.2.sa.conv_z.bias: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([128]).
	size mismatch for layers.2.sa.conv_output.weight: copying a param with shape torch.Size([384, 160, 3, 3]) from checkpoint, the shape in current model is torch.Size([192, 192, 3, 3]).
	size mismatch for layers.2.sa.conv_output.bias: copying a param with shape torch.Size([384]) from checkpoint, the shape in current model is torch.Size([192]).
	size mismatch for layers.3.conv.weight: copying a param with shape torch.Size([512, 256, 3, 3]) from checkpoint, the shape in current model is torch.Size([256, 128, 3, 3]).
	size mismatch for layers.3.conv.bias: copying a param with shape torch.Size([512]) from checkpoint, the shape in current model is torch.Size([256]).
	size mismatch for layers.3.sa.conv_h.weight: copying a param with shape torch.Size([96, 128, 1, 1]) from checkpoint, the shape in current model is torch.Size([384, 64, 1, 1]).
	size mismatch for layers.3.sa.conv_h.bias: copying a param with shape torch.Size([96]) from checkpoint, the shape in current model is torch.Size([384]).
	size mismatch for layers.3.sa.conv_m.weight: copying a param with shape torch.Size([64, 128, 1, 1]) from checkpoint, the shape in current model is torch.Size([256, 64, 1, 1]).
	size mismatch for layers.3.sa.conv_m.bias: copying a param with shape torch.Size([64]) from checkpoint, the shape in current model is torch.Size([256]).
	size mismatch for layers.3.sa.conv_z.weight: copying a param with shape torch.Size([32, 64, 1, 1]) from checkpoint, the shape in current model is torch.Size([128, 256, 1, 1]).
	size mismatch for layers.3.sa.conv_z.bias: copying a param with shape torch.Size([32]) from checkpoint, the shape in current model is torch.Size([128]).
	size mismatch for layers.3.sa.conv_output.weight: copying a param with shape torch.Size([384, 160, 3, 3]) from checkpoint, the shape in current model is torch.Size([192, 192, 3, 3]).
	size mismatch for layers.3.sa.conv_output.bias: copying a param with shape torch.Size([384]) from checkpoint, the shape in current model is torch.Size([192]).
	size mismatch for conv_output.weight: copying a param with shape torch.Size([2, 128, 1, 1]) from checkpoint, the shape in current model is torch.Size([2, 64, 1, 1]).
